function getDataFromLocalStorage(){fetch("assets/mock/stati.json").then((a=>{if(!a.ok)throw new Error("Network response was not ok");return a.json()})).then((a=>{localStorage.setItem("handsontableData",JSON.stringify(a))})).catch((a=>{showToast("loading-error","error",lang)}));const a=localStorage.getItem("handsontableData");return a?JSON.parse(a):[]}function saveDataToLocalStorage(a){localStorage.setItem("handsontableData",JSON.stringify(a))}function calculateSumRow(a){const e=Array(12).fill(0);return a.forEach((a=>{a.slice(1).forEach(((a,t)=>{isNaN(a)||(e[t]+=a)}))})),e}const container1=document.getElementById("hot1");if(container1){const a=new Handsontable(container1,{data:getDataFromLocalStorage(),colHeaders:["item","1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"],columns:[{data:0,type:"text",allowFillHandle:!0},...Array(12).fill({type:"numeric"})],fillHandle:{autoInsertRow:!0},colWidths:100,rowHeights:30,rowHeaders:!0,filters:!0,dropdownMenu:!0,contextMenu:!0,afterChange:function(e,o){if("loadData"!==o){const e=a.getData(),o=calculateSumRow(e);t.loadData([o]),updateChart(e),saveDataToLocalStorage(e)}},afterRemoveRow:function(e,o){const n=a.getData(),r=calculateSumRow(n);t.loadData([r]),updateChart(n),saveDataToLocalStorage(n)},licenseKey:"non-commercial-and-evaluation"}),e=document.getElementById("hot2"),t=new Handsontable(e,{data:[calculateSumRow(getDataFromLocalStorage())],colHeaders:["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"],columns:Array(12).fill({type:"numeric",readOnly:!0}),colWidths:110,rowHeaders:!1,licenseKey:"non-commercial-and-evaluation"}),o={chart:{type:"line",height:350},series:[],xaxis:{categories:["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"]},colors:["#FF5733","#33FF57","#3357FF","#FF33A1","#FF8C33","#33FFF5","#8C33FF","#FF3333","#33FF8C","#FF5733","#33A1FF","#FF33FF","#33FF33"]},n=new ApexCharts(document.querySelector("#chart"),o);function updateChart(a){const e=calculateSumRow(a),t=a.map((a=>({name:a[0],data:a.slice(1)})));t.push({name:"합계",data:e}),n.updateSeries(t)}n.render(),updateChart(getDataFromLocalStorage())}