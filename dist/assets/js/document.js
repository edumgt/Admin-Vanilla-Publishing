import{createAddButton,createCloseButton}from"./common.js";async function fetchDocuments(){const e=await fetch("assets/mock/documents.json");return await e.json()}const icons={pdf:"ðŸ“„",word:"ðŸ“",excel:"ðŸ“Š",hwp:"ðŸ“š"},workarea=document.getElementById("workarea");workarea.classList.add("flex","h-screen","mt-4");const documentList=document.getElementById("document-list"),addButton=createAddButton();addButton.addEventListener("click",(()=>{openNewDocumentModal()}));const btnArea=document.getElementById("btn-area");btnArea.classList.add("mt-4"),btnArea.appendChild(addButton);const viewer=document.getElementById("viewer");viewer.classList.add("flex-1","flex","items-center","justify-center","bg-gray-50");const newDocumentModal=document.getElementById("new-document-modal"),dropZone=document.getElementById("drop-zone"),fileInput=document.getElementById("file-input"),progressBar=document.getElementById("progress-bar"),progressBarInner=progressBar.querySelector("div");async function loadDocumentList(){(await fetchDocuments()).forEach(((e,n)=>{const t=document.createElement("div");t.className="flex items-center justify-start p-2 hover:bg-gray-100",t.dataset.index=n,t.innerHTML=`\n                    <span class="flex-1">${icons[e.type]}</span>\n                    <span class="flex-1">${e.title}</span>\n                    <span class="flex-1">${e.permissions}</span>\n                    <span class="flex-1">${e.uploadDate}</span>\n                    <span class="flex-1">${e.uploader}</span>\n                    <span class="flex-1 flex gap-2">\n                        <button class="bg-blue-500 text-white ${"none"===e.permissions?"opacity-50 cursor-not-allowed":""}" onclick="editDocument(${n})" ${"none"===e.permissions?"disabled":""}>Edit</button>\n                        <button class="bg-blue-500 text-white ${"none"===e.permissions?"opacity-50 cursor-not-allowed":""}" onclick="deleteDocument(${n})" ${"none"===e.permissions?"disabled":""}>Delete</button>\n                    </span>\n                `,t.addEventListener("click",(()=>previewDocument(e))),documentList.appendChild(t)}))}export function editDocument(e){}window.editDocument=editDocument;export function deleteDocument(e){}function previewDocument(e){if(viewer.innerHTML="","none"===e.permissions)return showToast("not-allowed","warning",lang),void(viewer.innerHTML='\n                    <button class="bg-blue-500 text-white  mt-4" onclick="requestPermission()">ê¶Œí•œ ìš”ì²­</button>\n                ');if("hwp"===e.type)return void(viewer.innerHTML="<p>HWP preview is not supported.</p>");if("pdf"===e.type)return void(viewer.innerHTML=`<iframe src="${e.url}" class="w-full h-full"></iframe>`);const n=document.createElement("iframe");n.src=e.url,viewer.appendChild(n)}window.deleteDocument=deleteDocument;export function requestPermission(){showToast("request-permission","success",lang)}function openNewDocumentModal(){newDocumentModal.classList.remove("hidden")}function closeNewDocumentModal(){newDocumentModal.classList.add("hidden")}function handleFileUpload(e){progressBar.classList.remove("hidden");let n=0;const t=setInterval((()=>{n+=20,progressBarInner.style.width=`${n}%`,n>=100&&(clearInterval(t),showToast("well-done","success",lang),closeNewDocumentModal(),progressBar.classList.add("hidden"),progressBarInner.style.width="0%")}),1e3)}window.requestPermission=requestPermission,dropZone.addEventListener("click",(()=>fileInput.click())),fileInput.addEventListener("change",handleFileUpload),dropZone.addEventListener("dragover",(e=>{e.preventDefault(),dropZone.classList.add("bg-gray-200")})),dropZone.addEventListener("dragleave",(()=>dropZone.classList.remove("bg-gray-200"))),dropZone.addEventListener("drop",(e=>{e.preventDefault(),dropZone.classList.remove("bg-gray-200"),handleFileUpload(e.dataTransfer.files)})),loadDocumentList();const closeButton=createCloseButton();closeButton.addEventListener("click",(()=>{closeNewDocumentModal()}));const closeBtn=document.getElementById("closeBtn");closeBtn.classList.add("mt-4","text-right"),closeBtn.appendChild(closeButton);